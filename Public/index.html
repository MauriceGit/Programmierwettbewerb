<!DOCTYPE html>
<html lang="en">
    <head>
    <title>Programmierwettbewerb</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <style>
            .jumbotron {
                background-image: url(Images/GameSample.jpg);
                color: white;
            }  
            .hidden {
                display:none;
            }
            .offset {
                margin-top: 50px;
            }
            h1 {
                margin-bottom: -10px;
            }
            body {
                padding-bottom: 100px;
            }
        </style>
        <script>
            var currentView = "";
            
            var views = {
                "home": { button:"#mnuHome", htmlContainer:"#mainHTML" },
                "rules": { button:"#mnuRules", htmlContainer:"#rulesHTML" },
                "botDevelopment": { button:"#mnuBotDevelopment", htmlContainer:"#botDevelopmentHTML" },
                "simulations": { button:"#mnuSimulations", htmlContainer:"#simulationsHTML" },
            };
        
            function openView(name) {                
                var mainContainer = $("#container");
                
                if (currentView != "") {
                    var previousHtmlContainer = $(views[currentView].htmlContainer);                    
                    var previousButton = $(views[currentView].button);                    
                    
                    previousHtmlContainer.html(mainContainer.children());
                    previousButton.removeClass("active");
                }
                
                var currentHtmlContainer = $(views[name].htmlContainer);
                var currentButton = $(views[name].button);

                mainContainer.html(currentHtmlContainer.children());                
                currentButton.addClass("active");
                
                currentView = name;
            }
            
            $(window).load(function(){
                openView("home");
                
                function handlerMaker(view) {
                    return function() { openView(view); };
                }
                
                for (var view in views) {
                    if (views.hasOwnProperty(view)) {
                        $(views[view].button).click(handlerMaker(view));
                    }
                }
            });
        </script>
    </head>
    <body>
        <div id="mainHTML" class="hidden">
            <div id="jumbotron" class="jumbotron">
                <h1>Agar.io</h1>
                <p>FH Wedel - Programmierwettbewerb Wintersemenster 2016</p> 
            </div>
            <a type="button" class="btn btn-success btn-block" href="game.html">Zum Spiel!</a>
        </div>
        <div id="rulesHTML" class="hidden">
            <div class="row">
                <div class="col-sm-4">
                    <h3>Regel 1</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit...</p>
                    <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>
                </div>
                <div class="col-sm-4">
                    <h3>Regel 2</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit...</p>
                    <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>
                </div>
                <div class="col-sm-4">
                    <h3>Regel 3</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit...</p>
                    <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>
                </div>
            </div>
        </div>
        <div id="botDevelopmentHTML" class="hidden">
            <h1>Einleitung</h1>
            <hr>
            <div>
                <p>
                    Alle Berechnungen zur Änderung des Spielzustands werden von einem Server übernommen. Pro Berechnungsschritt übermittelt 
                    dieser euren Bots den aktuellen Spielzustand, den ihr anschließend auswerten und in ein Kommando übersetzen müsst. Dieses müsst ihr
                    dem Server zurückschicken, um die nächste Handlung eures Bots bekannt zu geben. 
                <p>
                </p>
                    Damit ihr euch keine Gedanken, um die konkrete Übertragung von Daten zum Server machen müsst, haben wir ein kleines Program geschrieben, das euch diese Aufgabe abnimmt. Diese
                    Middleware startet eure Bots, leitet ihnen die Daten von Server über <code>stdin</code> weiter und wartet dann auf die Antwort eures Bots über <code>stdout</code>, um
                    diese anschließend wieder zum Server zu schicken.
                </p>
                <center><img src="Images/InformationFlow1.png" alignment="center" /></center>
                <p>Zum Testen startet ihr eure Bots wie folgt:</p>
                <pre>
./Programmierwettbewerb-Middleware -bot=myBot -name=myName</pre>
            </div>
            <h1 class="offset">Datenformate</h1>
            <hr>
            <p>
                Die Middleware schickt euch die Daten in einem an Python-orientierten Format und erwartet dies auch von euren Bots.
            </p>
            <div class="row">
                <div class="col-sm-6">
                    <h3>Eingabe <small>für eure Bots von der Middleware</small></h3>
                    <pre>
type BotId      = Int
type TeamId     = Int
type Index      = Int
type Position   = (Float, Float)
type Mass       = Int
type Blob       = (BotId, TeamId, Index, Position, Mass)
type Food       = (Position, Mass)
type Toxin      = (Position, Mass)
type OwnBlobs   = [Blob]
type OtherBlobs = [Blob]
type Input      = (OwnBlobs, OtherBlobs, [Food], [Toxin])</pre>
                </div>
                <div class="col-sm-6">
                    <h3>Ausgabe <small>von euren Bots an die Middleware</small></h3>
                    <pre>
data BlobAction = None | Throw | Split
type Position   = (Float, Float)
type Output     = (BlobAction, Position)</pre>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <h4>Beispiel für Eingabe <small>(Zeilenumbrüche nicht berücksichtigen)</small></h4>
                    <pre>
    ([(1,2,3,(4,5),6)],
     [(7,8,9,(10,11),12)],
     [((13,14),15)],
     [((16,17),18)])</pre>
                </div>
                <div class="col-sm-6">
                    <h4>Beispiel für Ausgabe</h4>
                    <pre>
    (None,(1,2))</pre>
                </div>
            </div>
            <h1 class="offset">Parser</h1>
            <hr>
            <p>In dieser Übersicht sehr ihr, wie ihr die Eingabe in verschiedenen Sprachen parsen könnt.</p>
            <div class="row">
                <div class="col-md-12">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Sprache</th>
                                <th>Parser</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Python</td>
                                <td>Die Eingabe kann mit der Funktion <code>eval</code> geparst werden.</td>
                            </tr>
                            <tr>
                                <td>C</td>
                                <td><a target="_blank" href="https://github.com/hpatjens/Programmierwettbewerb/blob/master/BotCpp/BotCpp/pwb.h">Hier</a> stellen wir einen Parser bereit.</td>
                            </tr>
                            <tr>
                                <td>Haskell</td>
                                <td>Wenn ihr die entsprechenden Datenstrukturen anlegt, könnt ihr die Eingabe mit <code>read</code> (Typklasse <code>Read</code>) einlesen.</td>
                            </tr>
                            <tr>
                                <td>...</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <p>Bitte sagt Bescheid, wenn ihr weitere Sprachen kennt, mit denen dieses Format leicht zu parsen ist. Wenn ihr eure Parser anderen Teilnehmern bereitstellen wollt, nehmen wir diese natürlich auch gerne in diese Auflistung auf.</p>
            <h1 class="offset">Beispiel-Bots</h1>            
            <hr>
            <div class="row">
                <div class="col-sm-6">
                    <h3>Python</h3>
                    <pre>
def process(data) {
     // TODO: Calculate the target and action of your bot!
}
                    
while (1):
    line = sys.stdin.readline()
    data = eval(line)
    print process(data)</pre>
                    <a href="https://github.com/hpatjens/Programmierwettbewerb/tree/master/BotPython" class="btn btn-default">Show in Repository</a>
                </div>
                <div class="col-sm-6">
                    <h3>C</h3>
                    <pre>
#define PWB_IMPLEMENTATION
#include "pwb.h"

BotCommand process(const VisibleGameState* const visibleGameState) {
    Vec2 target;
    BotActionType botActionType;

    // TODO: Calculate the target and action of your bot!

    return pwb_mkBotCommand(botActionType, &target);
}

int main() {
    #define INPUT_BUFFER_MAX_LENGTH 2000
    #define OUTPUT_BUFFER_MAX_LENGTH 100

    char inputBuffer[INPUT_BUFFER_MAX_LENGTH];
    char outputBuffer[OUTPUT_BUFFER_MAX_LENGTH];

    for (;;) {
        pwb_getline(inputBuffer, INPUT_BUFFER_MAX_LENGTH);

        ParseContext parseContext = pwb_mkContext(inputBuffer);

        VisibleGameState visibleGameState;
        if (!pwb_parseAll(&parseContext, &visibleGameState)) {
            pwb_printErrors(&parseContext, stderr);
            exit(1);
        }

        BotCommand botCommand = process(&visibleGameState);

        pwb_toString(outputBuffer, &botCommand);
        printf("%s\n", outputBuffer);
        fflush(stdout);
    }

    return 0;
}</pre>
                    <a href="https://github.com/hpatjens/Programmierwettbewerb/tree/master/BotCpp" class="btn btn-default">Show in Repository</a>
                </div>
            </div>
        </div>
        <div id="simulationsHTML" class="hidden">
            <h1>Allgemeines</h1>
            <hr>
            <div class="row">
                <div class="col-sm-4">
                    <h3>Main-Loop</h3>
                    <p>
                        Der Server führt alle Simulationen mit einer konstanten Frequenz von 30Hz aus. D.h. zwischen den Simulationsschritten liegen etwas über &Delta;t = 33ms. Wird die Frequenz belastungsbedingt nicht erreicht, rechnen wir jedoch trotzdem mit dem selben &Delta;t. Dadurch erreichen wird stabile Simulationen jedoch läuft das Spiel in diesem Moment langsamer.
                    </p>
                    <p>
                        Die Reihenfolge der Simulationen ist nicht-deterministisch. Das bedeutet, ihr könnt keine Vor- oder Nachteile durch die Simulationsreihenfolge erlangen.
                    </p>
                    <p>

                    </p>
                </div>
                <div class="col-sm-4">
                    <h3>Spawnen von Spielelementen</h3>
                    <p>
                        ...
                    </p>
                </div>
                <div class="col-sm-4">
                    <h3>Geschwindigkeit und Position</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit...</p>
                    <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>
                </div>
            </div>
            <hr>
            <h1>Aktionen</h1>
            <div class="row">
                <div class="col-sm-4">
                    <h3>Teilen und Explodieren</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit...</p>
                    <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>
                </div>
                <div class="col-sm-4">
                    <h3>Masse werfen und Teilen von Gift</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit...</p>
                    <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>
                </div>
            </div>
        </div>
        <nav class="navbar navbar-default navbar-static-top">
            <div class="container">
            <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">Programmierwettbewerb</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li class="active" id="mnuHome"><a href="#">Home</a></li>
                    <!--<li id="mnuRules"><a href="#">Spielregeln</a></li>-->
                    <li id="mnuBotDevelopment"><a href="#">Bot-Entwicklung</a></li>
                    <!--<li id="mnuSimulations"><a href="#">Server-Simulationen</a></li>-->
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="https://github.com/hpatjens/Programmierwettbewerb">Repository</a></li>                    
                </ul>
            </div><!--/.nav-collapse -->
            </div>
        </nav>
        
        <div id="container" class="container">
        </div>
    </body>
</html>
